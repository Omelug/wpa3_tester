$schema: http://json-schema.org/draft-07/schema#
name: channel_switch_test
#wizard_fallback: true
attacker_module: channel_switch
ignore_interfaces: [wlan0]
actors:
  access_point:
    type: AP
    source: internal
    selection:
      condition: [AP]
    setup:
      program: hostapd
      program_config:
        driver: nl80211
        ssid: test_channel_switch
        hw_mode: g
        auth_algs: 1
        wpa: 2
        ieee80211n: 1
        ieee80211w: 2
        wpa_key_mgmt: SAE
        rsn_pairwise: CCMP
        wpa_passphrase: password123
        channel: 6
      channel: 6 # not set in hostapd, set once before test
    ip_addr: "10.0.0.1"
  client:
    type: STA
    source: internal
    setup:
      program: wpa_supplicant
      program_config:
        ssid: test_channel_switch
        sae_password: password123
        ieee80211w: 2
        proto: RSN
        key_mgmt: SAE
        pairwise: CCMP
        group: CCMP
      channel: 6
    #mon_iface: mon #TODO
    netns: sta
    ip_addr: "10.0.0.2"
  attacker:
    type: STA
    source: internal
    selection:
      driver: mt76x2u # rtl8xxxu didnt work, maybe other work
      condition: [monitor]
    channel: 6

attack_config:
  validator: ./channel_switch.schema.yaml
  attack_time: 30
  ms_interval: 100
  new_channel: 1
